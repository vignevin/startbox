% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/data_merge.R
\name{prepare_final_data}
\alias{prepare_final_data}
\title{Prepare Final Merged Dataset with Metadata}
\usage{
prepare_final_data(self)
}
\arguments{
\item{self}{An instance of the \code{UserData} R6 class containing observation data and metadata.}
}
\value{
A \code{data.frame} with observation data enriched by plot and treatment metadata.
If no observation data is available, returns only the merged plot + modality metadata.
If required metadata is missing, returns \code{NULL} with a message.
}
\description{
Merges observation data with metadata sheets ("placette" and "modalite") if available.
The function first joins the plot-level and treatment-level metadata, then links the result to the combined observation data
using the \code{plot_id} column.
}
\details{
\itemize{
\item Assumes that \code{self$metadata$plot_desc} contains \code{factor_level_code} and \code{plot_id}.
\item Assumes that \code{self$metadata$moda_desc} contains \code{xp_trt_code}.
\item If \code{self$combined_data} is not set, calls to \code{combine_data_obs()} are made automatically.
}
}
