% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/data_merge.R
\name{merge_with_existing_data}
\alias{merge_with_existing_data}
\title{Merge Combined Data with Existing Excel Sheet}
\usage{
merge_with_existing_data(wb, combined)
}
\arguments{
\item{wb}{A \code{workbook} object from the \code{openxlsx2} package, representing the loaded Excel trial file.}

\item{combined}{A \code{data.frame} containing newly combined and standardized observation data to be merged.}
}
\value{
A \code{data.frame} containing both the original and new data, with duplicates replaced if applicable.
}
\description{
Merges newly combined observation data with any existing data stored in the "data" sheet of an Excel workbook.
Ensures consistent data types and avoids duplication based on \code{prov_name}.
}
\details{
\itemize{
\item Converts key columns (\code{prov_name}, \code{plot_id}, etc.) to character to ensure compatibility.
\item Converts all \verb{*_PC} columns to numeric format.
\item If the \code{prov_name} already exists in the original data, the corresponding rows are replaced by the new data.
\item Removes the existing "data" worksheet from the workbook to prepare for writing the updated version.
}
}
